<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UDHAAR â€” Inventory Management</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Kaushan+Script&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=ITC Bauhaus&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Ovo&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">

  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Anime.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>

  <style>
    :root {
      --blue:#2563EB;
      --green:#16A34A;
      --gold:#B86B45;
      --dark:#1F2937;
      --muted:#F3F4F6;
      --card:#FFFFFF;
      --low-stock: #f59e0b;
      --out-of-stock: #ef4444;
      --sufficient-stock: #10b981;
      --sidebar-width: 250px;
      --transition-speed: 0.3s;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, 'Helvetica Neue', Arial;
      color: var(--dark);
      background-color: #f9fafb;
      overflow-x: hidden;
    }

    a { text-decoration: none; color: inherit; }

    /* Nav & Header */
    .nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 18px 28px;
      background-color: var(--dark);
      color: #fff;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 100;
    }

    .logo { display: flex; gap: 12px; align-items: center; }
    .logo img { height: 44px; width: 44px; border-radius: 6px; object-fit: cover; }
    .logo h1 { font-family: 'Josefin Sans', sans-serif; margin: 0; font-size: 20px; color: #fff; }
.bauhaus-text .la {
    font-family: 'ITC Bauhaus','Seasons', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    font-weight: lighter;
    color: #ff9900;
    position: relative;
    }
    .bauhaus-text .ma {
    font-family: 'Kaushan Script', cursive;
    font-weight: lighter;
    color: #a8690a;
    position: relative;
    }
    
    .user-profile {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      font-size: 16px;
      font-family: 'Inter', sans-serif;
      position: relative;
    }

    .user-profile .profile-icon {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background-color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      color: var(--dark);
      font-weight: 600;
      border: 2px solid var(--gold);
    }

    .user-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      width: 180px;
      padding: 10px 0;
      margin-top: 10px;
      display: none;
      z-index: 101;
    }

    .user-dropdown.show {
      display: block;
      animation: fadeIn 0.2s ease-in-out;
    }

    .user-dropdown a {
      display: block;
      padding: 10px 20px;
      color: var(--dark);
      transition: background-color 0.2s;
    }

    .user-dropdown a:hover {
      background-color: var(--muted);
    }

    .menu-icon {
      font-size: 24px;
      cursor: pointer;
      margin-right: 20px;
    }

    /* Main Container */
    .main-container {
      display: flex;
      padding-top: 80px;
      min-height: 100vh;
    }

    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      background-color: #fff;
      padding: 20px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.05);
      position: fixed;
      left: 0;
      top: 80px;
      bottom: 0;
      display: flex;
      flex-direction: column;
      transform: translateX(-250px);
      transition: transform var(--transition-speed) ease-in-out;
      z-index: 99;
      overflow-y: auto;
    }

    .sidebar.visible {
      transform: translateX(0);
    }
    
    .sidebar h2 {
      font-family: 'Cinzel', serif;
      letter-spacing: 1px;
      font-size: 18px;
      margin-bottom: 20px;
      text-align: center;
    }
    .sidebar ul {
      list-style-type: none;
    }
    .sidebar li a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      margin-bottom: 8px;
      border-radius: 8px;
      font-weight: 600;
      transition: background-color 0.2s ease, color 0.2s ease;
    }
    .sidebar li a i {
      width: 20px;
      text-align: center;
    }
    .sidebar li a:hover {
      background-color: var(--muted);
      color: var(--gold);
    }
    .sidebar li a.active {
      background-color: var(--gold);
      color: #fff;
    }

    /* Content Area */
    .content-area {
      flex: 1;
      margin-left: 0;
      padding: 28px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      transition: margin-left var(--transition-speed) ease-in-out;
    }

    /* Adjust content margin when sidebar is visible */
    .content-area.shifted {
      margin-left: var(--sidebar-width);
    }

    /* Quick Stats */
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 20px;
    }
    .stat-card {
      background-color: var(--card);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      text-align: center;
      transition: transform 0.2s, box-shadow 0.2s;
      cursor: pointer;
    }
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 15px rgba(0,0,0,0.1);
    }
    .stat-card h4 {
      font-size: 14px;
      text-transform: uppercase;
      color: #666;
      margin-bottom: 8px;
    }
    .stat-card .value {
      font-size: 28px;
      font-weight: 700;
      font-family: 'Josefin Sans', sans-serif;
    }
    .stat-card .trend {
      font-size: 12px;
      margin-top: 5px;
    }
    .trend.up {
      color: var(--sufficient-stock);
    }
    .trend.down {
      color: var(--out-of-stock);
    }

    /* Inventory Section */
    .inventory-section {
      background-color: var(--card);
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      padding: 20px;
      overflow: hidden;
    }
    .inventory-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .inventory-header h3 {
      font-family: 'Cinzel', serif;
      font-size: 24px;
    }
    .inventory-header .add-btn {
      background-color: var(--gold);
      color: #fff;
      padding: 10px 20px;
      border-radius: 30px;
      font-weight: 600;
      transition: background-color 0.2s ease;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .inventory-header .add-btn:hover {
      background-color: #a55c38;
    }
    
    .search-filter-bar {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .search-filter-bar input, .search-filter-bar select {
      flex: 1;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      min-width: 150px;
    }

    /* Product Table */
    .table-container {
      overflow-x: auto;
    }
    .product-table {
      width: 100%;
      border-collapse: collapse;
      min-width: 600px;
    }
    .product-table th, .product-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    .product-table th {
      background-color: var(--muted);
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: sticky;
      top: 0;
      cursor: pointer;
    }
    .product-table th:hover {
      background-color: #e5e7eb;
    }
    .product-table th i {
      margin-left: 5px;
      font-size: 12px;
    }
    .product-table tr {
      transition: background-color 0.2s;
    }
    .product-table tr:hover {
      background-color: #f9fafb;
    }
    .status-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      color: #fff;
    }
    .status-low { background-color: var(--low-stock); }
    .status-out { background-color: var(--out-of-stock); }
    .status-ok { background-color: var(--sufficient-stock); }
    .action-btns {
      display: flex;
      gap: 10px;
    }
    .action-btns button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: #666;
      transition: color 0.2s;
    }
    .action-btns button:hover {
      color: var(--dark);
    }

    /* Pagination */
    .pagination {
      display: flex;
      justify-content: center;
      margin-top: 20px;
      gap: 8px;
    }
    .pagination button {
      padding: 8px 12px;
      border: 1px solid #ddd;
      background-color: white;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .pagination button:hover {
      background-color: var(--muted);
    }
    .pagination button.active {
      background-color: var(--gold);
      color: white;
      border-color: var(--gold);
    }

    /* Add/Edit Modal Form */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.6);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      display: none;
    }
    .modal.show { 
      display: flex;
      animation: fadeIn 0.3s;
    }
    .modal-content {
      background-color: #fff;
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      position: relative;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      max-height: 90vh;
      overflow-y: auto;
    }
    .modal-content h3 {
      font-family: 'Cinzel', serif;
      margin-bottom: 20px;
    }
    .modal-content form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }
    .form-group label {
      font-weight: 600;
      font-size: 14px;
    }
    .modal-content input, .modal-content select, .modal-content textarea {
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-family: inherit;
    }
    .modal-content .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 24px;
      cursor: pointer;
      color: #999;
      transition: color 0.2s;
    }
    .modal-content .close-btn:hover {
      color: var(--dark);
    }
    .modal-content button {
      padding: 12px;
      background-color: var(--dark);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 10px;
      transition: background-color 0.2s;
    }
    .modal-content button:hover {
      background-color: #111827;
    }

    /* Toast notifications */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 20px;
      border-radius: 8px;
      color: white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 10000;
      display: flex;
      align-items: center;
      gap: 10px;
      transform: translateX(100%);
      transition: transform 0.3s ease-out;
    }
    .toast.show {
      transform: translateX(0);
    }
    .toast.success {
      background-color: var(--sufficient-stock);
    }
    .toast.warning {
      background-color: var(--low-stock);
    }
    .toast.error {
      background-color: var(--out-of-stock);
    }
    .toast.info {
      background-color: var(--blue);
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes fadeInOut {
      0% { opacity: 0; transform: translateY(-20px); }
      10% { opacity: 1; transform: translateY(0); }
      90% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-20px); }
    }

    /* Responsive */
    @media (max-width: 980px) {
      .main-container { flex-direction: column; }
      .sidebar {
        width: 100%;
        position: relative;
        top: 0;
        transform: translateX(0);
      }
      .content-area {
        margin-left: 0;
        padding-top: 20px;
      }
      .stats-bar { grid-template-columns: repeat(2, 1fr); }
      .menu-icon { display: none; }
    }
    
    @media (min-width: 981px) {
      .sidebar.visible {
        transform: translateX(0);
      }
      .content-area.shifted {
        margin-left: var(--sidebar-width);
      }
    }

    @media (max-width: 768px) {
      .stats-bar { grid-template-columns: 1fr; }
      .inventory-header { flex-direction: column; gap: 10px; align-items: flex-start; }
      .search-filter-bar { flex-direction: column; }
      .nav { padding: 15px; }
      .content-area { padding: 20px; }
    }

    @media (max-width: 520px) {
      .stats-bar { grid-template-columns: 1fr; }
      .modal-content { padding: 20px; }
    }

    /* Loading animation */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  
  <div class="nav">
    <div class="logo">
      <span class="menu-icon" id="menu-icon">â˜°</span>
      <img src="/assets/logo2.png" alt="Udhaar logo">
      <h1 class="bauhaus-text"><span class="la">Udhaa</span><span class="ma">R</span></h1>
    </div>
    <div class="user-profile" id="user-profile">
      <span class="profile-icon">ðŸ‘¤</span>
      <span>Shopkeeper</span>
      <div class="user-dropdown" id="user-dropdown">
        <a href="/support.html"><i class="fas fa-user"></i> Profile</a>
        <a href="/setting.html"><i class="fas fa-cog"></i> Settings</a>
        <a href="/index.html"><i class="fas fa-sign-out-alt"></i> Logout</a>
      </div>
    </div>
  </div>

  <div class="main-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <h2>UDHAAR</h2>
      <ul>
        <li><a href="/dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
        <li><a href="/udhaar.html"><i class="fas fa-credit-card"></i> Udhaar</a></li>
        <li><a href="/inventory.html" class="active"><i class="fas fa-boxes"></i> Inventory</a></li>
        <li><a href="/report.html"><i class="fas fa-chart-bar"></i> Reports</a></li>
        <li><a href="/setting.html"><i class="fas fa-cog"></i> Settings</a></li>
      </ul>
    </aside>

    <!-- Main Content Area -->
    <main class="content-area" id="content-area">
      <!-- Quick Stats -->
      <section class="stats-bar">
        <div class="stat-card" id="total-items">
          <h4>Total Items</h4>
          <span class="value">245</span>
          <div class="trend up">+12% from last month</div>
        </div>
        <div class="stat-card" id="low-stock-items">
          <h4>Low Stock Items</h4>
          <span class="value">12</span>
          <div class="trend down">+3 from last week</div>
        </div>
        <div class="stat-card" id="out-of-stock">
          <h4>Out of Stock</h4>
          <span class="value">3</span>
          <div class="trend down">-2 from yesterday</div>
        </div>
        <div class="stat-card" id="inventory-value">
          <h4>Total Inventory Value</h4>
          <span class="value">â‚¹ 1.25L</span>
          <div class="trend up">+5.2% from last month</div>
        </div>
      </section>

      <!-- Inventory List -->
      <section class="inventory-section">
        <div class="inventory-header">
          <h3>Inventory Management</h3>
          <button class="add-btn" id="add-product-btn">
            <i class="fas fa-plus"></i> Add New Product
          </button>
        </div>
        
        <div class="search-filter-bar">
          <input type="text" id="search-bar" placeholder="Search by item name..." />
          <select id="filter-stock">
            <option value="all">Show All</option>
            <option value="low">Low Stock Only</option>
            <option value="out">Out of Stock Only</option>
          </select>
          <select id="sort-category">
            <option value="all">All Categories</option>
            <option value="grocery">Grocery</option>
            <option value="household">Household</option>
            <option value="snacks">Snacks</option>
            <option value="personal">Personal Care</option>
          </select>
        </div>
        
        <div class="table-container">
          <table class="product-table">
            <thead>
              <tr>
                <th data-sort="name">Item Name <i class="fas fa-sort"></i></th>
                <th data-sort="stock">Available Stock (Qty) <i class="fas fa-sort"></i></th>
                <th data-sort="price">Price per Unit (â‚¹) <i class="fas fa-sort"></i></th>
                <th data-sort="category">Category <i class="fas fa-sort"></i></th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="inventory-list">
              <!-- Sample Data -->
              <tr>
                <td>Detergent Powder (500g)</td>
                <td>12</td>
                <td>150.00</td>
                <td>Household</td>
                <td><span class="status-badge status-ok">Sufficient</span></td>
                <td class="action-btns">
                  <button title="Edit" data-action="edit" data-id="1"><i class="fas fa-edit"></i></button>
                  <button title="Delete" data-action="delete" data-id="1"><i class="fas fa-trash"></i></button>
                </td>
              </tr>
              <tr>
                <td>Basmati Rice (1kg)</td>
                <td>5</td>
                <td>180.00</td>
                <td>Grocery</td>
                <td><span class="status-badge status-low">Low Stock</span></td>
                <td class="action-btns">
                  <button title="Edit" data-action="edit" data-id="2"><i class="fas fa-edit"></i></button>
                  <button title="Delete" data-action="delete" data-id="2"><i class="fas fa-trash"></i></button>
                </td>
              </tr>
              <tr>
                <td>Biscuits (Chocolate)</td>
                <td>0</td>
                <td>20.00</td>
                <td>Snacks</td>
                <td><span class="status-badge status-out">Out of Stock</span></td>
                <td class="action-btns">
                  <button title="Edit" data-action="edit" data-id="3"><i class="fas fa-edit"></i></button>
                  <button title="Delete" data-action="delete" data-id="3"><i class="fas fa-trash"></i></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div class="pagination" id="pagination">
          <button id="prev-page"><i class="fas fa-chevron-left"></i></button>
          <button class="active">1</button>
          <button>2</button>
          <button>3</button>
          <button id="next-page"><i class="fas fa-chevron-right"></i></button>
        </div>
      </section>
    </main>
  </div>

  <!-- Add/Edit Product Modal -->
  <div class="modal" id="product-modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h3 id="modal-title">Add New Product</h3>
      <form id="product-form">
        <input type="hidden" id="product-id" value="">
        <div class="form-group">
          <label for="item-name">Item Name</label>
          <input type="text" id="item-name" placeholder="Item Name" required />
        </div>
        <div class="form-group">
          <label for="category">Category</label>
          <select id="category" required>
            <option value="">Select Category</option>
            <option value="grocery">Grocery</option>
            <option value="household">Household</option>
            <option value="snacks">Snacks</option>
            <option value="personal">Personal Care</option>
          </select>
        </div>
        <div class="form-group">
          <label for="selling-price">Selling Price (â‚¹)</label>
          <input type="number" id="selling-price" placeholder="Selling Price" step="0.01" min="0" required />
        </div>
        <div class="form-group">
          <label for="cost-price">Cost Price (â‚¹)</label>
          <input type="number" id="cost-price" placeholder="Cost Price" step="0.01" min="0" required />
        </div>
        <div class="form-group">
          <label for="current-stock">Current Stock (Qty)</label>
          <input type="number" id="current-stock" placeholder="Current Stock" min="0" required />
        </div>
        <div class="form-group">
          <label for="low-stock-threshold">Low Stock Threshold</label>
          <input type="number" id="low-stock-threshold" placeholder="Low Stock Threshold (e.g., 10)" min="1" required />
        </div>
        <div class="form-group">
          <label for="description">Description (Optional)</label>
          <textarea id="description" placeholder="Product description..." rows="3"></textarea>
        </div>
        <button type="submit" id="submit-btn">
          <span id="submit-text">Save Product</span>
          <span id="submit-loading" class="loading" style="display: none;"></span>
        </button>
      </form>
    </div>
  </div>

  <script>
    // Inventory data structure
    let inventoryData = [
      { id: 1, name: "Detergent Powder (500g)", stock: 12, price: 150.00, category: "household", threshold: 5, costPrice: 120.00, description: "" },
      { id: 2, name: "Basmati Rice (1kg)", stock: 5, price: 180.00, category: "grocery", threshold: 10, costPrice: 150.00, description: "" },
      { id: 3, name: "Biscuits (Chocolate)", stock: 0, price: 20.00, category: "snacks", threshold: 15, costPrice: 15.00, description: "" }
    ];

    // Current state
    let currentPage = 1;
    const itemsPerPage = 10;
    let sortField = 'name';
    let sortDirection = 'asc';

    document.addEventListener('DOMContentLoaded', () => {
      const menuIcon = document.getElementById('menu-icon');
      const sidebar = document.getElementById('sidebar');
      const contentArea = document.getElementById('content-area');
      const userProfile = document.getElementById('user-profile');
      const userDropdown = document.getElementById('user-dropdown');
      
      // Sidebar toggle
      menuIcon.addEventListener('click', (event) => {
        event.preventDefault();
        sidebar.classList.toggle('visible');
        contentArea.classList.toggle('shifted');
      });

      // User dropdown toggle
      userProfile.addEventListener('click', (event) => {
        event.stopPropagation();
        userDropdown.classList.toggle('show');
      });

      // Close dropdown when clicking elsewhere
      document.addEventListener('click', (event) => {
        if (!userProfile.contains(event.target)) {
          userDropdown.classList.remove('show');
        }
      });

      const addProductBtn = document.getElementById('add-product-btn');
      const productModal = document.getElementById('product-modal');
      const closeBtn = document.querySelector('.close-btn');
      const modalTitle = document.getElementById('modal-title');
      const productForm = document.getElementById('product-form');
      const productIdField = document.getElementById('product-id');
      const submitBtn = document.getElementById('submit-btn');
      const submitText = document.getElementById('submit-text');
      const submitLoading = document.getElementById('submit-loading');

      // Show modal for adding product
      addProductBtn.addEventListener('click', () => {
        modalTitle.textContent = 'Add New Product';
        productIdField.value = '';
        productForm.reset();
        productModal.classList.add('show');
      });

      // Hide modal
      closeBtn.addEventListener('click', () => {
        productModal.classList.remove('show');
      });

      // Hide modal when clicking outside
      window.addEventListener('click', (event) => {
        if (event.target === productModal) {
          productModal.classList.remove('show');
        }
      });

      // Table sorting
      document.querySelectorAll('.product-table th[data-sort]').forEach(header => {
        header.addEventListener('click', () => {
          const field = header.getAttribute('data-sort');
          
          // Toggle direction if same field
          if (sortField === field) {
            sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
          } else {
            sortField = field;
            sortDirection = 'asc';
          }
          
          // Update UI
          document.querySelectorAll('.product-table th i').forEach(icon => {
            icon.className = 'fas fa-sort';
          });
          
          const icon = header.querySelector('i');
          icon.className = `fas fa-sort-${sortDirection === 'asc' ? 'up' : 'down'}`;
          
          // Sort and render data
          sortInventoryData();
          renderInventoryTable();
        });
      });

      // Handle form submission
      productForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Show loading state
        submitText.style.display = 'none';
        submitLoading.style.display = 'inline-block';
        
        // Simulate API call delay
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        const formData = new FormData(productForm);
        const product = {
          id: productIdField.value || Date.now(), // Use timestamp as ID for new products
          name: document.getElementById('item-name').value,
          category: document.getElementById('category').value,
          price: parseFloat(document.getElementById('selling-price').value),
          costPrice: parseFloat(document.getElementById('cost-price').value),
          stock: parseInt(document.getElementById('current-stock').value),
          threshold: parseInt(document.getElementById('low-stock-threshold').value),
          description: document.getElementById('description').value
        };
        
        if (productIdField.value) {
          // Update existing product
          const index = inventoryData.findIndex(item => item.id == productIdField.value);
          if (index !== -1) {
            inventoryData[index] = product;
            showToast('Product updated successfully!', 'success');
          }
        } else {
          // Add new product
          inventoryData.push(product);
          showToast('Product added successfully!', 'success');
        }
        
        // Update UI
        renderInventoryTable();
        updateStats();
        
        // Hide modal and reset form
        productModal.classList.remove('show');
        productForm.reset();
        
        // Reset button state
        submitText.style.display = 'inline-block';
        submitLoading.style.display = 'none';
      });

      // Handle edit/delete actions
      document.getElementById('inventory-list').addEventListener('click', (e) => {
        const button = e.target.closest('button');
        if (!button) return;
        
        const action = button.getAttribute('data-action');
        const id = button.getAttribute('data-id');
        const product = inventoryData.find(item => item.id == id);
        
        if (action === 'edit') {
          modalTitle.textContent = 'Edit Product';
          productIdField.value = product.id;
          document.getElementById('item-name').value = product.name;
          document.getElementById('category').value = product.category;
          document.getElementById('selling-price').value = product.price;
          document.getElementById('cost-price').value = product.costPrice;
          document.getElementById('current-stock').value = product.stock;
          document.getElementById('low-stock-threshold').value = product.threshold;
          document.getElementById('description').value = product.description || '';
          productModal.classList.add('show');
        } else if (action === 'delete') {
          showConfirmDialog(
            'Delete Product',
            'Are you sure you want to delete this product? This action cannot be undone.',
            () => {
              inventoryData = inventoryData.filter(item => item.id != id);
              renderInventoryTable();
              updateStats();
              showToast('Product deleted successfully.', 'success');
            }
          );
        }
      });

      // Search functionality
      document.getElementById('search-bar').addEventListener('input', (e) => {
        renderInventoryTable();
      });

      // Filter functionality
      document.getElementById('filter-stock').addEventListener('change', () => {
        renderInventoryTable();
      });

      // Category filter
      document.getElementById('sort-category').addEventListener('change', () => {
        renderInventoryTable();
      });

      // Pagination
      document.getElementById('next-page').addEventListener('click', () => {
        if (currentPage < Math.ceil(getFilteredData().length / itemsPerPage)) {
          currentPage++;
          renderInventoryTable();
        }
      });

      document.getElementById('prev-page').addEventListener('click', () => {
        if (currentPage > 1) {
          currentPage--;
          renderInventoryTable();
        }
      });

      // Initialize
      renderInventoryTable();
      updateStats();
    });

    // Helper functions
    function getFilteredData() {
      const searchTerm = document.getElementById('search-bar').value.toLowerCase();
      const stockFilter = document.getElementById('filter-stock').value;
      const categoryFilter = document.getElementById('sort-category').value;
      
      return inventoryData.filter(item => {
        // Search filter
        if (searchTerm && !item.name.toLowerCase().includes(searchTerm)) {
          return false;
        }
        
        // Stock status filter
        if (stockFilter === 'low' && item.stock > item.threshold) {
          return false;
        }
        if (stockFilter === 'out' && item.stock > 0) {
          return false;
        }
        
        // Category filter
        if (categoryFilter !== 'all' && item.category !== categoryFilter) {
          return false;
        }
        
        return true;
      });
    }

    function sortInventoryData() {
            inventoryData.sort((a, b) => {
        let valueA = a[sortField];
        let valueB = b[sortField];
        
        // Handle string comparison
        if (typeof valueA === 'string') {
          valueA = valueA.toLowerCase();
          valueB = valueB.toLowerCase();
        }
        
        if (valueA < valueB) {
          return sortDirection === 'asc' ? -1 : 1;
        }
        if (valueA > valueB) {
          return sortDirection === 'asc' ? 1 : -1;
        }
        return 0;
      });
    }

    function renderInventoryTable() {
      const tableBody = document.getElementById('inventory-list');
      const filteredData = getFilteredData();
      const pagination = document.getElementById('pagination');
      
      // Calculate pagination
      const totalPages = Math.ceil(filteredData.length / itemsPerPage);
      const startIndex = (currentPage - 1) * itemsPerPage;
      const endIndex = Math.min(startIndex + itemsPerPage, filteredData.length);
      const pageData = filteredData.slice(startIndex, endIndex);
      
      // Clear table
      tableBody.innerHTML = '';
      
      // Populate table with data
      pageData.forEach(item => {
        const status = getStockStatus(item.stock, item.threshold);
        const statusClass = status === 'Sufficient' ? 'status-ok' : 
                           status === 'Low Stock' ? 'status-low' : 'status-out';
        
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${item.name}</td>
          <td>${item.stock}</td>
          <td>${item.price.toFixed(2)}</td>
          <td>${capitalizeFirstLetter(item.category)}</td>
          <td><span class="status-badge ${statusClass}">${status}</span></td>
          <td class="action-btns">
            <button title="Edit" data-action="edit" data-id="${item.id}"><i class="fas fa-edit"></i></button>
            <button title="Delete" data-action="delete" data-id="${item.id}"><i class="fas fa-trash"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
      
      // Update pagination controls
      updatePaginationControls(totalPages);
    }
    
    function updatePaginationControls(totalPages) {
      const paginationContainer = document.getElementById('pagination');
      const prevButton = document.getElementById('prev-page');
      const nextButton = document.getElementById('next-page');
      
      // Clear number buttons (keep prev/next)
      const numberButtons = paginationContainer.querySelectorAll('button:not(#prev-page):not(#next-page)');
      numberButtons.forEach(btn => btn.remove());
      
      // Add number buttons
      for (let i = 1; i <= totalPages; i++) {
        const button = document.createElement('button');
        button.textContent = i;
        if (i === currentPage) {
          button.classList.add('active');
        }
        button.addEventListener('click', () => {
          currentPage = i;
          renderInventoryTable();
        });
        paginationContainer.insertBefore(button, nextButton);
      }
      
      // Update prev/next button states
      prevButton.disabled = currentPage === 1;
      nextButton.disabled = currentPage === totalPages || totalPages === 0;
    }
    
    function getStockStatus(stock, threshold) {
      if (stock === 0) {
        return 'Out of Stock';
      } else if (stock <= threshold) {
        return 'Low Stock';
      } else {
        return 'Sufficient';
      }
    }
    
    function updateStats() {
      // Calculate stats
      const totalItems = inventoryData.length;
      const lowStockItems = inventoryData.filter(item => item.stock > 0 && item.stock <= item.threshold).length;
      const outOfStockItems = inventoryData.filter(item => item.stock === 0).length;
      const inventoryValue = inventoryData.reduce((sum, item) => sum + (item.costPrice * item.stock), 0);
      
      // Update DOM
      document.getElementById('total-items').querySelector('.value').textContent = totalItems;
      document.getElementById('low-stock-items').querySelector('.value').textContent = lowStockItems;
      document.getElementById('out-of-stock').querySelector('.value').textContent = outOfStockItems;
      document.getElementById('inventory-value').querySelector('.value').textContent = `â‚¹ ${formatCurrency(inventoryValue)}`;
    }
    
    function formatCurrency(amount) {
      if (amount >= 100000) {
        return (amount / 100000).toFixed(2) + 'L';
      } else if (amount >= 1000) {
        return (amount / 1000).toFixed(2) + 'K';
      }
      return amount.toFixed(2);
    }
    
    function capitalizeFirstLetter(string) {
      return string.charAt(0).toUpperCase() + string.slice(1);
    }
    
    function showToast(message, type = 'info') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.innerHTML = `
        <i class="fas ${type === 'success' ? 'fa-check-circle' : 
                     type === 'warning' ? 'fa-exclamation-triangle' : 
                     type === 'error' ? 'fa-times-circle' : 'fa-info-circle'}"></i>
        <span>${message}</span>
      `;
      
      document.body.appendChild(toast);
      
      // Show toast
      setTimeout(() => toast.classList.add('show'), 10);
      
      // Hide after 3 seconds
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }
    
    function showConfirmDialog(title, message, confirmCallback) {
      // Create modal for confirmation
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.innerHTML = `
        <div class="modal-content" style="max-width: 400px;">
          <h3>${title}</h3>
          <p>${message}</p>
          <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button id="confirm-cancel" style="background-color: #6b7280;">Cancel</button>
            <button id="confirm-ok" style="background-color: #ef4444;">Delete</button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      modal.classList.add('show');
      
      // Add event listeners
      document.getElementById('confirm-cancel').addEventListener('click', () => {
        modal.classList.remove('show');
        setTimeout(() => modal.remove(), 300);
      });
      
      document.getElementById('confirm-ok').addEventListener('click', () => {
        confirmCallback();
        modal.classList.remove('show');
        setTimeout(() => modal.remove(), 300);
      });
      
      // Close when clicking outside
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.remove('show');
          setTimeout(() => modal.remove(), 300);
        }
      });
    }
  </script>
</body>
</html>